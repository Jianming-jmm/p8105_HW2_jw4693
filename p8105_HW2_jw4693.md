p8105 HW2
================
Jianming Wang
2024-09-12

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(readxl)
```

# Problem 1

## import and read the data

``` r
subway <- read_csv('NYC_Transit_Subway_Entrance_And_Exit_Data.csv')|>
  janitor::clean_names()
```

    ## Rows: 1868 Columns: 32
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (22): Division, Line, Station Name, Route1, Route2, Route3, Route4, Rout...
    ## dbl  (8): Station Latitude, Station Longitude, Route8, Route9, Route10, Rout...
    ## lgl  (2): ADA, Free Crossover
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
head(subway)
```

    ## # A tibble: 6 × 32
    ##   division line    station_name station_latitude station_longitude route1 route2
    ##   <chr>    <chr>   <chr>                   <dbl>             <dbl> <chr>  <chr> 
    ## 1 BMT      4 Aven… 25th St                  40.7             -74.0 R      <NA>  
    ## 2 BMT      4 Aven… 25th St                  40.7             -74.0 R      <NA>  
    ## 3 BMT      4 Aven… 36th St                  40.7             -74.0 N      R     
    ## 4 BMT      4 Aven… 36th St                  40.7             -74.0 N      R     
    ## 5 BMT      4 Aven… 36th St                  40.7             -74.0 N      R     
    ## 6 BMT      4 Aven… 45th St                  40.6             -74.0 R      <NA>  
    ## # ℹ 25 more variables: route3 <chr>, route4 <chr>, route5 <chr>, route6 <chr>,
    ## #   route7 <chr>, route8 <dbl>, route9 <dbl>, route10 <dbl>, route11 <dbl>,
    ## #   entrance_type <chr>, entry <chr>, exit_only <chr>, vending <chr>,
    ## #   staffing <chr>, staff_hours <chr>, ada <lgl>, ada_notes <chr>,
    ## #   free_crossover <lgl>, north_south_street <chr>, east_west_street <chr>,
    ## #   corner <chr>, entrance_latitude <dbl>, entrance_longitude <dbl>,
    ## #   station_location <chr>, entrance_location <chr>

Here, I first import the subway data as my raw data, and clean up the
variable names. After importing, I have a look at the data.

## Clean the data

``` r
subway <- subway|>
  select(line, station_name, station_latitude, station_longitude, route1, route2, route3, route4, route5, route6, route7, route8, route9, route10, route11, entry, vending, entrance_latitude, entrance_longitude, entrance_type, ada)|>
  mutate(entry = if_else(entry == 'YES', TRUE, FALSE))|>
  unique()
head(subway)
```

    ## # A tibble: 6 × 21
    ##   line     station_name station_latitude station_longitude route1 route2 route3
    ##   <chr>    <chr>                   <dbl>             <dbl> <chr>  <chr>  <chr> 
    ## 1 4 Avenue 25th St                  40.7             -74.0 R      <NA>   <NA>  
    ## 2 4 Avenue 25th St                  40.7             -74.0 R      <NA>   <NA>  
    ## 3 4 Avenue 36th St                  40.7             -74.0 N      R      <NA>  
    ## 4 4 Avenue 36th St                  40.7             -74.0 N      R      <NA>  
    ## 5 4 Avenue 36th St                  40.7             -74.0 N      R      <NA>  
    ## 6 4 Avenue 45th St                  40.6             -74.0 R      <NA>   <NA>  
    ## # ℹ 14 more variables: route4 <chr>, route5 <chr>, route6 <chr>, route7 <chr>,
    ## #   route8 <dbl>, route9 <dbl>, route10 <dbl>, route11 <dbl>, entry <lgl>,
    ## #   vending <chr>, entrance_latitude <dbl>, entrance_longitude <dbl>,
    ## #   entrance_type <chr>, ada <lgl>

``` r
summary(subway)
```

    ##      line           station_name       station_latitude station_longitude
    ##  Length:1868        Length:1868        Min.   :40.58    Min.   :-74.03   
    ##  Class :character   Class :character   1st Qu.:40.69    1st Qu.:-73.99   
    ##  Mode  :character   Mode  :character   Median :40.73    Median :-73.96   
    ##                                        Mean   :40.73    Mean   :-73.94   
    ##                                        3rd Qu.:40.77    3rd Qu.:-73.91   
    ##                                        Max.   :40.90    Max.   :-73.76   
    ##                                                                          
    ##     route1             route2             route3             route4         
    ##  Length:1868        Length:1868        Length:1868        Length:1868       
    ##  Class :character   Class :character   Class :character   Class :character  
    ##  Mode  :character   Mode  :character   Mode  :character   Mode  :character  
    ##                                                                             
    ##                                                                             
    ##                                                                             
    ##                                                                             
    ##     route5             route6             route7              route8     
    ##  Length:1868        Length:1868        Length:1868        Min.   :1.000  
    ##  Class :character   Class :character   Class :character   1st Qu.:1.000  
    ##  Mode  :character   Mode  :character   Mode  :character   Median :4.000  
    ##                                                           Mean   :2.979  
    ##                                                           3rd Qu.:5.000  
    ##                                                           Max.   :5.000  
    ##                                                           NA's   :1820   
    ##      route9         route10        route11       entry        
    ##  Min.   :2.000   Min.   :3      Min.   :7      Mode :logical  
    ##  1st Qu.:2.000   1st Qu.:3      1st Qu.:7      FALSE:115      
    ##  Median :2.000   Median :3      Median :7      TRUE :1753     
    ##  Mean   :2.536   Mean   :3      Mean   :7                     
    ##  3rd Qu.:2.000   3rd Qu.:3      3rd Qu.:7                     
    ##  Max.   :5.000   Max.   :3      Max.   :7                     
    ##  NA's   :1840    NA's   :1845   NA's   :1845                  
    ##    vending          entrance_latitude entrance_longitude entrance_type     
    ##  Length:1868        Min.   :40.58     Min.   :-74.03     Length:1868       
    ##  Class :character   1st Qu.:40.69     1st Qu.:-73.99     Class :character  
    ##  Mode  :character   Median :40.73     Median :-73.96     Mode  :character  
    ##                     Mean   :40.73     Mean   :-73.86                       
    ##                     3rd Qu.:40.77     3rd Qu.:-73.91                       
    ##                     Max.   :40.90     Max.   : 73.99                       
    ##                                                                            
    ##     ada         
    ##  Mode :logical  
    ##  FALSE:1400     
    ##  TRUE :468      
    ##                 
    ##                 
    ##                 
    ## 

After importing, based on the need of the problem, I select rows about
information of line, station, name, station latitude / longitude, routes
served, entry, vending, entrance type, entrance latitude / longitude and
ADA compliance. Then, I convert the entry information to logical
variable and delete the duplicated rows. There are 1868 rows and 21
columns in this data, and its dimension is 39228. The data is tidy, in
which each row represents a unique station entrance, each column
represents a different variable and each cell contains only one value.

## Answer questions

``` r
distinct(subway,line,station_name)|>
  nrow()
```

    ## [1] 465

``` r
select(subway,line,station_name,ada)|>
  unique()|>
  pull(ada)|>
  sum()
```

    ## [1] 84

``` r
filter(subway, vending == 'NO')|>
  pull(entry)|>
  mean()
```

    ## [1] 0.3770492

Totally, there are 465 distinct stations, among which 84 stations are
ADA compliant. The proportion of station entrances / exits without
vending that allow entrance is 0.377(37.7%).

## Reformating the data

``` r
subway$route8 <- as.character(subway$route8)
subway$route9 <- as.character(subway$route9)
subway$route10 <- as.character(subway$route10)
subway$route11 <- as.character(subway$route11)
subway_tidy = 
  pivot_longer(
    subway, 
    route1:route11,
    names_to = "route_number", 
    values_to = "route_name")
subway_A <- select(subway_tidy, line, station_name, route_name)|>
  filter(route_name == 'A')|>
  unique()
nrow(subway_A)
```

    ## [1] 60

``` r
subway_ADA <- select(subway, line, station_name, ada)|>
  unique()
left_join(subway_A,subway_ADA,by = c('line','station_name'))|>
  pull(ada)|>
  sum()
```

    ## [1] 17

There are 60 distinct stations serving the A train, 17 of which are ADA
compliant.

# Problem 2

## Importing and cleaning for “Mr. Trash Wheel” sheet

``` r
Trashwheel <- read_excel('202309 Trash Wheel Collection Data.xlsx', sheet = 1, range = 'A2:N586')|>
  janitor::clean_names()
Trashwheel$sports_balls <- as.integer(Trashwheel$sports_balls)
head(Trashwheel)
```

    ## # A tibble: 6 × 14
    ##   dumpster month year  date                weight_tons volume_cubic_yards
    ##      <dbl> <chr> <chr> <dttm>                    <dbl>              <dbl>
    ## 1        1 May   2014  2014-05-16 00:00:00        4.31                 18
    ## 2        2 May   2014  2014-05-16 00:00:00        2.74                 13
    ## 3        3 May   2014  2014-05-16 00:00:00        3.45                 15
    ## 4        4 May   2014  2014-05-17 00:00:00        3.1                  15
    ## 5        5 May   2014  2014-05-17 00:00:00        4.06                 18
    ## 6        6 May   2014  2014-05-20 00:00:00        2.71                 13
    ## # ℹ 8 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, plastic_bags <dbl>,
    ## #   wrappers <dbl>, sports_balls <int>, homes_powered <dbl>

## Importing and cleaning for “Professor Trash Wheel” and “Gwynnda” sheet and combine data

``` r
Trashwheel_2 <- read_excel('202309 Trash Wheel Collection Data.xlsx', sheet = 2, range = 'A2:M108')|>
  janitor::clean_names()
Trashwheel_3 <- read_excel('202309 Trash Wheel Collection Data.xlsx', sheet = 4, range = 'A2:L157')|>
  janitor::clean_names()
```

``` r
Trashwheel <- mutate(Trashwheel,trashwheel_name = 'Mr. Trash Wheel')|>
  select(-1)
Trashwheel_2 <- mutate(Trashwheel_2,trashwheel_name = 'Professor Trash Wheel')|>
  select(-1)
Trashwheel_3 <- mutate(Trashwheel_3,trashwheel_name = 'Gwynnda Trash Wheel')|>
  select(-1)
Trashwheel$year <- as.numeric(Trashwheel$year)
Trashwheel_total <- bind_rows(Trashwheel,Trashwheel_2,Trashwheel_3)|>
  relocate(trashwheel_name)|>
  mutate(dumpster = 1:845)|>
  relocate(dumpster)
```

There are totally 845 observations in the dataset, including information
about date/month/year of using Trashwheels, the weight trashwheels
colllect and weights or numbers of different types of rubbish such as
plastic bottles, glass bottles, plastic bags, cigarette butts and so on.
Also, it contains information about different types of Trashwheel and
number of homes powered. The total weight of trash collected by
Professor Trash Wheel is 216.26t. In June of 2022, Gwynnda collected
totally 1.812^{4} cigarette butts.
